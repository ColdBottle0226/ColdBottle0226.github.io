---
title:  "[Github Blog] ë¸”ë¡œê·¸ ê²Œì‹œë¬¼ ì‘ì„±ë°©ë²•" 
excerpt: "ê¹ƒí—™ ë¸”ë¡œê·¸ëŠ” ë¬´ì—‡ì´ê³  ì™œ ì“°ëŠ” ê±¸ê¹Œ?"

categories:
  - Blog
tags:
  - [Blog, Github]

toc: true
toc_sticky: true
 
date: 2024-03-03
last_modified_at: 2024-03-03

---

# 1. Java Exception

---

Javaì—ëŠ” Checked Exceptionê³¼ Unchecked Exceptionì´ ì¡´ì¬

### 1.1 Checked Exception

---

- ì˜ˆì™¸ ì²˜ë¦¬ í•„ìˆ˜ : `try-catch` ë¬¸ìœ¼ë¡œ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ê±°ë‚˜ ìƒìœ„ ë©”ì„œë“œë¡œ ë„˜ê²¨ì¤˜ì•¼ í•œë‹¤.
- Transaction ê¸°ë³¸ ë¡¤ë°± ëŒ€ìƒì´ ì•„ë‹ˆë¼ì„œ ë¡¤ë°± ì²˜ë¦¬í•˜ë ¤ë©´ ì¶”ê°€ ì²˜ë¦¬ í•„ìš”í•˜ë‹¤.
- ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ ì²´í¬

### 1.2 Unchecked Exception

---

- ì˜ˆì™¸ ì²˜ë¦¬ í•„ìˆ˜ ì•„ë‹˜
- Transaction ë¡¤ë°± ëŒ€ìƒ
- ëŸ°íƒ€ì„ ë‹¨ê³„ì—ì„œ ì²´í¬

<aside>
ğŸ’¡ ì»´íŒŒì¼ íƒ€ì„ : ê¸°ê³„ì–´ ì½”ë“œë¡œ ë³€í™˜ë˜ì–´ ì‹¤í–‰ ê°€ëŠ¥í•œ í”„ë¡œê·¸ë¨ì´ ë˜ëŠ” í¸ì§‘ ê³¼ì •
                       ex) Syntax ì˜¤ë¥˜, Type Check ì˜¤ë¥˜
ëŸ°íƒ€ì„ :  ì»´íŒŒì¼ ê³¼ì •ì„ ë§ˆì¹œ í”„ë¡œê·¸ë¨ì´ ë™ì‘ ë˜ëŠ” ê³¼ì •
               ex) Null ì°¸ì¡° ì˜¤ë¥˜, ë©”ëª¨ë¦¬ ë¶€ì¡± ì˜¤ë¥˜

</aside>

# 2. Spring Exceptionì˜ HTTP Status

---

## 2.1. @ResponseStatus

---

```java
@ResponseStatus(code = HttpStatus.NOT_FOUND, reason = "Data Not Found")
public class DataNotFoundException extends RuntimeException{ }
```

@ResponseStatus : Http Statusì™€ Responseë¥¼ ì œê³µí•˜ëŠ” ì–´ë…¸í…Œì´ì…˜

ê°œë°œìê°€ ì •ì˜í•œ Exceptionì´ ë°œìƒí•˜ë©´ í•´ë‹¹ Statusì™€ Messageë¥¼ ì „ë‹¬í•œë‹¤.

### **@ResponseStatus ì •ì˜ëœ Custom Exception ì‚¬ìš©**

```jsx
{
  "timestamp": "2021-03-13T07:30:38.299+00:00",
  "status": 404,
  "error": "Not Found",
  "message": "Data Not Found",
  "path": "/auth/signup"
}
```

### **í•œê³„ì **

@ResponseStatus ì— ì •ì˜ëœ ëŒ€ë¡œ ì˜ ë‚˜ì˜¤ì§€ë§Œ, ìœ„ì—ì„œ ì •ì˜í•œ DataNotFoundExceptionì€ í•­ìƒ ë™ì¼í•œ HTTP Statusì™€ Messageë¥¼  ë¦¬í„´í•œë‹¤.

ì¦‰, ê°™ì€ Exceptionì´ ë°œìƒí•˜ëŠ” ìƒí™©ì´ë¼ë„ ë‹¤ë¥¸ Messageë¥¼ ë³´ë‚´ëŠ”ê²Œ ë¶ˆê°€ëŠ¥í•˜ë‹¤.

## 2.2. ResponseStatusException

---

@ResponseStatusì˜ ëŒ€ì²´ì œë¡œ Spring 5ë¶€í„° ë“±ì¥

ë§ˆì°¬ê°€ì§€ë¡œ HTTP Statusì™€ Messageë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

```java
public ResponseStatusException(
		HttpStatus status,
		@Nullable String reason,
		@Nullable Throwable cause
){}
```

`Status`: HTTP Status

`reason`: HTTP response Message

`cause`: ResponseStatusExceptionì„ ë°œìƒì‹œí‚¨ Exception

ìŠ¤í”„ë§ì—ì„œëŠ”Â **HandlerExceptionResolver**Â ê°€ ëª¨ë“  exception ì„ ê°€ë¡œì±„ì„œ ì²˜ë¦¬í•œë‹¤.

ì´ ì¤‘ì—ì„œÂ **ResponseStatusExceptionResolver**Â ë¼ëŠ” í´ë˜ìŠ¤ê°€Â 

**ResponseStatusException**Â ë˜ëŠ”Â **@ResponseStatus**Â ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ Exception ì„ ì°¾ì•„ì„œ ì²˜ë¦¬í•´ì¤€ë‹¤.

# 3. Spring ì „ì—­ìœ¼ë¡œ ê³µí†µ Exception ì²˜ë¦¬í•˜ê¸°

---

### ResponseStatusExceptionì˜ ì¼ë°˜ì ì¸ ì‚¬ìš©

```java
throw new ResponseStatusException(HttpStatus.NOT_FOUND, "No Data");
```

- ë‹¤ìŒê³¼ ê°™ì´ ê·œê²© ì—†ì´, Stringìœ¼ë¡œë§Œ messageë¥¼ ë°›ìœ¼ë©´, ì—¬ëŸ¬ ì‚¬ëŒë“¤ì´ ì‘ì—…í•  ë•Œ ì¤‘ë³µëœ ì‘ë‹µì„ ì£¼ê±°ë‚˜ ì´ë¯¸ ìˆëŠ” ì‘ë‹µì„ ìƒˆë¡œ ë§Œë“¤ê±°ë‚˜, ì˜¤íƒ€ë¡œ ì¸í•´ ì‹¤ìˆ˜ í•  ìˆ˜ ìˆë‹¤.

ë”°ë¼ì„œ Spring Exception ì²˜ë¦¬ëŠ” ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ì§„í–‰ëœë‹¤.

- ErrorCode : í•µì‹¬. ëª¨ë“  ì˜ˆì™¸ ì¼€ì´ìŠ¤ë¥¼ ì´ê³³ì—ì„œ ê´€ë¦¬
- CustomException : ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µë˜ëŠ” Exception ì™¸ì— ì‚¬ìš©
- ErrorResponse : ì‚¬ìš©ìì—ê²Œ JSON í˜•ì‹ìœ¼ë¡œ ë³´ì—¬ì£¼ê¸° ìœ„í•´ ì—ëŸ¬ ì‘ë‹µ í˜•ì‹ ì§€ì •
- GlobalExceptionHandler : Custom Excepton Handler
    - @ControllerAdvice : í”„ë¡œì íŠ¸ ì „ì—­ì—ì„œ ë°œìƒí•˜ëŠ” Exceptionì„ ì¡ê¸° ìœ„í•œ í´ë˜ìŠ¤
    - @ExceptionHandler : íŠ¹ì • Exceptionì„ ì§€ì •í•´ì„œ ë³„ë„ë¡œ ì²˜ë¦¬í•´ì¤Œ

## 3.1. ErrorCode

---

```java
@Getter
@AllArgsConstructor
public enum ErrorCode {

    /* 400 BAD_REQUEST : ì˜ëª»ëœ ìš”ì²­ */
    INVALID_REFRESH_TOKEN(400, BAD_REQUEST, "ë¦¬í”„ë ˆì‹œ í† í°ì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"),
    MISMATCH_REFRESH_TOKEN(400, BAD_REQUEST, "ë¦¬í”„ë ˆì‹œ í† í°ì˜ ìœ ì € ì •ë³´ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"),
    CANNOT_FOLLOW_MYSELF(400, BAD_REQUEST, "ìê¸° ìì‹ ì€ íŒ”ë¡œìš° í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"),

    /* 401 UNAUTHORIZED : ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ì */
    INVALID_AUTH_TOKEN(401, UNAUTHORIZED, "ê¶Œí•œ ì •ë³´ê°€ ì—†ëŠ” í† í°ì…ë‹ˆë‹¤"),
    UNAUTHORIZED_MEMBER(401, UNAUTHORIZED, "í˜„ì¬ ë‚´ ê³„ì • ì •ë³´ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"),

    /* 404 NOT_FOUND : Resource ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ */
    MEMBER_NOT_FOUND(404, NOT_FOUND, "í•´ë‹¹ ìœ ì € ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"),
    REFRESH_TOKEN_NOT_FOUND(404, NOT_FOUND, "ë¡œê·¸ì•„ì›ƒ ëœ ì‚¬ìš©ìì…ë‹ˆë‹¤"),
    NOT_FOLLOW(404, NOT_FOUND, "íŒ”ë¡œìš° ì¤‘ì´ì§€ ì•ŠìŠµë‹ˆë‹¤"),

    /* 409 CONFLICT : Resource ì˜ í˜„ì¬ ìƒíƒœì™€ ì¶©ëŒ. ë³´í†µ ì¤‘ë³µëœ ë°ì´í„° ì¡´ì¬ */
    DUPLICATE_RESOURCE(409, CONFLICT, "ë°ì´í„°ê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤"),

    ;

		private final int status;
    private final String errorCode;
    private final String message;
}
```

- ì—ëŸ¬ í˜•ì‹ì„ Enum í´ë˜ìŠ¤ë¡œ ì •ì˜í•œë‹¤.
- ì‘ë‹µìœ¼ë¡œ ë‚´ë³´ë‚¼ HttpStatusì™€ ì—ëŸ¬ ë©”ì‹œì§€ë¡œ ì‚¬ìš©í•  Stringì„ ê°–ê³  ìˆë‹¤.
- ê°œë°œìê°€ ì •ì˜í•œ ìƒˆë¡œìš´ Exceptionì„ ëª¨ë‘ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ê³  ì¬ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.

## 3.2. CustomException

---

```java
@Getter
@AllArgsConstructor
public class CustomException extends RuntimeException {
    private final ErrorCode errorCode;
}
```

- ì „ì—­ìœ¼ë¡œ ì‚¬ìš©í•  CustomException
- `RuntimeException`Â ì„ ìƒì†ë°›ì•„ì„œ Unchecked Exception ìœ¼ë¡œ í™œìš©í•œë‹¤.
- ìƒì„±ìë¡œÂ `ErrorCode`Â ë¥¼ ë°›ëŠ”ë‹¤.

## 3.3. ErrorResponse

---

```java
@Getter
@Builder
public class ErrorResponse {
    private final LocalDateTime timestamp = LocalDateTime.now();
    private final int status;
    private final String error;
    private final String code;
    private final String message;

    public static ResponseEntity<ErrorResponse> toResponseEntity(ErrorCode errorCode) {
        return ResponseEntity
                .status(errorCode.getHttpStatus())
                .body(ErrorResponse.builder()
                        .status(errorCode.getHttpStatus().value())
                        .error(errorCode.getHttpStatus().name())
                        .code(errorCode.name())
                        .message(errorCode.getDetail())
                        .build()
                );
    }
}
```

- ì‹¤ì œë¡œ ìœ ì €ì—ê²Œ ë³´ë‚¼ ì‘ë‹µ Format
- ErrorCodeë¥¼ ë°›ì•„ì„œ ResponseEntity<ErrorResponse>ë¡œ ë³€í™˜í•´ì¤€ë‹¤.

## 3.4. @ControllerAdvice ì™€ @ExceptionHandler

---

@RestControllerAdvice ëŠ” í”„ë¡œì íŠ¸ ì „ì—­ì—ì„œ ë°œìƒí•˜ëŠ” ëª¨ë“  ì˜ˆì™¸ë¥¼ ì¡ì•„ì¤€ë‹¤.

@ExceptionHandler ëŠ” ë°œìƒí•œ íŠ¹ì • ì˜ˆì™¸ë¥¼ ì¡ì•„ì„œ í•˜ë‚˜ì˜ ë©”ì†Œë“œì—ì„œ ê³µí†µ ì²˜ë¦¬í•´ì¤„ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

```java
@Slf4j
@RestControllerAdvice
public class GlobalExceptionHandler extends ResponseEntityExceptionHandler {

    @ExceptionHandler(value = { ConstraintViolationException.class, DataIntegrityViolationException.class})
    protected ResponseEntity<ErrorResponse> handleDataException() {
        log.error("handleDataException throw Exception : {}", DUPLICATE_RESOURCE);
        return ErrorResponse.toResponseEntity(DUPLICATE_RESOURCE);
    }

    @ExceptionHandler(value = { CustomException.class })
    protected ResponseEntity<ErrorResponse> handleCustomException(CustomException e) {
        log.error("handleCustomException throw CustomException : {}", e.getErrorCode());
        return ErrorResponse.toResponseEntity(e.getErrorCode());
    }
}
```

## 3.5 Exception ì‚¬ìš©

```java
@RequiredArgsConstructor
@Service
public class MemberService {
    private final MemberRepository memberRepository;

    @Transactional
    public boolean follow(Long memberId) {
        Member currentMember = getCurrentMember();

        // íŒ”ë¡œìš°í•  ìƒëŒ€ë°© ì •ë³´ê°€ ì—†ëŠ” ê²½ìš°
        Member targetMember = memberRepository.findById(memberId)
                .orElseThrow(() -> new CustomException(MEMBER_NOT_FOUND));

        // ìê¸° ìì‹ ì„ íŒ”ë¡œìš° í•˜ë ¤ëŠ” ê²½ìš°
        if (currentMember.equals(targetMember))  {
            throw new CustomException(CANNOT_FOLLOW_MYSELF);
        }

                // code...
    }
}
```

### MEMBER_NOT_FOUND ì‹¤ì œ ì‘ë‹µ

```java
{
  "timestamp": "2021-03-14T03:29:01.878659",
  "status": 404,
  "error": "NOT_FOUND",
  "code": "MEMBER_NOT_FOUND",
  "message": "í•´ë‹¹ ìœ ì € ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
}
```

### CANNOT_FOLLOW_MYSELF ì‹¤ì œ ì‘ë‹µ

```java
{
  "timestamp": "2021-03-14T03:16:25.98361",
  "status": 400,
  "error": "BAD_REQUEST",
  "code": "CANNOT_FOLLOW_MYSELF",
  "message": "ìê¸° ìì‹ ì€ íŒ”ë¡œìš° í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
}
```