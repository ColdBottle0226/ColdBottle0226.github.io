---
title:  "IOC & DI" 
excerpt: "ìŠ¤í”„ë§ ì»¨ì…‰"

categories:
  - Spring
tags:
  - [Spring, DI, IOC]

toc: true
toc_sticky: true
 
date: 2024-04-15
last_modified_at: 2024-04-15

---

## ğŸ“• 2.2.1 ì œì–´ì˜ ì—­ì „(IOC)ê³¼ ì˜ì¡´ì„± ì£¼ì…(DI)

### ğŸ“Œ IOC (Inversion of Control)

- ìë°”ì—ì„œ ë‹¤ë¥¸ ê°ì²´ë¥¼ ì§ì ‘ ìƒì„±í•˜ê±°ë‚˜ ì œì–´í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì™¸ë¶€(Spring Framework)ì—ì„œ ê´€ë¦¬í•˜ëŠ” ê°ì²´ë¥¼ ê°€ì ¸ì™€ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤.
- ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ì˜¤ë¸Œì íŠ¸(ë¹ˆ)ì˜ ìƒì„±ê³¼ ì˜ì¡´ ê´€ê³„ ì„¤ì •, ì‚¬ìš©, ì œê±° ë“±ì˜ ì‘ì—…ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ëŒ€ì‹  ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ë‹´ë‹¹í•œë‹¤.

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ê°ì²´ë¥¼ ê´€ë¦¬í•˜ëŠ” ë°©ì‹ ì˜ˆì œ

```java
public class A {
	private B b;	
}
```

A í´ë˜ìŠ¤ì—ì„œ B ê°ì²´ë¥¼ ì§ì ‘ ìƒì„±í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, ì£¼ì…ë°›ì•„ì„œ ì´ë¥¼ ì‚¬ìš©í•œë‹¤.

---

### ğŸ“Œ DI (Dependency Injection)

- IOCì—ì„œ ê°ì²´ë¥¼ ì£¼ì…í•˜ëŠ” ë°©ì‹ì„ DIë¼ê³  ë¶€ë¥¸ë‹¤.
- ìŠ¤í”„ë§ì—ì„œëŠ” ê°ì²´ë“¤ì„ ê´€ë¦¬í•˜ê¸° ìœ„í•´ IOCë¥¼ ì‚¬ìš©í•˜ê³ , ì´ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ DI(ì˜ì¡´ì„± ì£¼ì…)ì´ë‹¤.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/33bf96cc-c7fe-4b18-a1a7-5a05eeb5927e/f4cc54e9-2e1c-4a53-9444-0802467ee8cc/Untitled.png)

---

### ğŸ“Œ DI ë°©ì‹

### âœï¸ **1. Field Injection( í•„ë“œ ì£¼ì… )**

ë‹¨ìˆœíˆ í•„ë“œ ì£¼ì… ë°©ì‹ì€ ë³€ìˆ˜ ì„ ì–¸ë¶€ì— `**@Autowired**` ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì¸ë‹¤.

```java
@RestController
public class SampleController{
		
		@Autowired
		private SampleService sampleService;

}
```

**Field Injection(í•„ë“œ ì£¼ì…)ì˜ ë‹¨ì **

- **SRP(ë‹¨ì¼ ì±…ì„ ì›ì¹™)**ì˜ ì›ì¹™ì„ í•´ì¹  ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§„ë‹¤.
    - ê°„ë‹¨í•œ ì‚¬ìš©ë²• ì•„ë˜ ê°œìˆ˜ ì œí•œ ì—†ì´ ë¬´í•œì • ì¶”ê°€í•˜ê²Œ ë˜ê³  Classê°€ ë§ì€ ì±…ì„ì„ ë– ì•ˆê²Œ ëœë‹¤
- ì˜ì¡´ì„±ì´ ìˆ¨ëŠ”ë‹¤.
    - í•„ë“œ ì£¼ì…ì˜ ê²½ìš°ì—ëŠ” ì™¸ë¶€ì—ì„œ í•´ë‹¹ í´ë˜ìŠ¤ê°€ ì–´ë–¤ ì˜ì¡´ì„±ì˜ ì±…ì„(ìš©ë„)ì„ ì§€ê³  ìˆëŠ”ì§€ ì•Œ ìˆ˜ ì—†ë‹¤.
- DI ì»¨í…Œì´ë„ˆì˜ ê²°í•©ì„±ê³¼ í…ŒìŠ¤íŠ¸ ìš©ì´ì„±
    - DI í”„ë ˆì„ì›Œí¬ì˜ í•µì‹¬ì€ ê´€ë¦¬ë˜ëŠ” Classê°€ DI Containerì— ì˜ì¡´ì„±ì´ ì—†ì–´ì•¼ í•œë‹¤. ì´ëŠ” DI Containerê°€ í•„ìš”í•œ ì˜ì¡´ì„±ì„ ì „ë‹¬ë§Œ í•˜ë©´ ê·¸ ì´í›„ì—”Â **ë…ë¦½ëœ ê°œì²´**ê°€ ë˜ì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤.
    - ë…ë¦½ëœ ê°œì²´ê°€ ë˜ë©´ Testì—ì„œë„ ìš©ì´í•˜ë‹¤.
    - í•˜ì§€ë§Œ í•„ë“œ ì£¼ì…ì€Â **DI Containerì— ì˜ì¡´ì„±ì„ ê°€ì§€ê²Œ ëœë‹¤**. (DI ì»¨í…Œì´ë„ˆê°€ ì—†ìœ¼ë©´ í…ŒìŠ¤íŠ¸ ë¶ˆê°€)
- ë¶ˆë³€ì„±ì„ í™œìš©í•  ìˆ˜ ì—†ë‹¤
    - ìƒì„±ì ì´í›„ì— í˜¸ì¶œë˜ë¯€ë¡œ, í•„ë“œì— **final í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.**

### âœï¸ **2. Setter Injection( ìˆ˜ì •ì ì£¼ì… )**

**setter ë©”ì„œë“œ**ì— `**@Autowired**` ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ ì˜ì¡´ì„±ì„ ì£¼ì…í•˜ëŠ” ë°©ì‹ì„ ë§í•œë‹¤.

```java
@RestController
public class SampleController{
		
		private SampleService sampleService;

		@Autowired
		public void setSampleService(SampleService sampleService){
			this.sampleService = sampleService;
		}
}
```

- **`Setter Injection`ì„ í†µí•´ì„œ Serviceì˜ êµ¬í˜„ì²´ë¥¼ ì£¼ì…í•´ì£¼ì§€ ì•Šì•„ë„ Controller ê°ì²´ëŠ” ìƒì„±ì´ ê°€ëŠ¥í•˜ì§€ë§Œ** setì„ í†µí•´Â **Serviceì˜ êµ¬í˜„ì²´ë¥¼ ì£¼ì…í•´ì£¼ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ, NullPointerException ì´ ë°œìƒí•œë‹¤.**
- ë¶ˆë³€ì„±ì„ í™œìš©í•  ìˆ˜ ì—†ë‹¤
    - ìƒì„±ì ì´í›„ì— í˜¸ì¶œë˜ë¯€ë¡œ, í•„ë“œì— **final í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.**

### âœï¸ **3. Constructor Injection( ìƒì„±ì ì£¼ì… )**

ìƒì„±ìë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ì¡´ì„±ì„ ì£¼ì…í•˜ëŠ” ë°©ì‹ì´ë‹¤.

```java
@RestController
public class SampleController{
		
		private SampleService sampleService;

		@Autowired
		public SampleService(SampleService sampleService){
			this.sampleService = sampleService;
		}
}
```

- **NullPointerException**ì˜ ë°œìƒì„ ë§‰ëŠ”ë‹¤.
    - ê¸°ì¡´ Setter Injectionì˜ ë‹¨ì ì„ ë³´ì™„í•œë‹¤. ìƒì„±ì‹œì— ì˜ì¡´ì„± ì—†ì´ëŠ” ìƒì„± ë¶ˆê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ì¼ë¶€ëŸ¬ nullì„ ì£¼ì…í•˜ì§€ ì•ŠëŠ” ì´ìƒ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.
- ë¶ˆë³€ì„±ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.
    - finalë¡œ ì„ ì–¸ ê°€ëŠ¥í•˜ë‹¤.
- SRP(ë‹¨ì¼ ì±…ì„ ì›ì¹™)ì„ ì§€í‚¬ ìˆ˜ ìˆë„ë¡ ìœ ë„í•œë‹¤.
    - ì‚¬ìš©í•˜ê¸°ê°€ ì•½ê°„ ë¶ˆí¸í•˜ê³  ìƒì„±ìì˜ ì½”ë“œê°€ ê¸¸ì–´ì§ì„ ëŠë‚„ ìˆ˜ë°–ì— ì—†ê²Œ ë˜ì–´ ìˆë‹¤. ë”°ë¼ì„œ ì½”ë“œê°€ ê¸¸ì–´ì§„ë‹¤ë©´ ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ë‹¤ì‹œ í•œë²ˆ ìƒê°í•˜ê²Œ í•´ ì¤€ë‹¤.
- ë”°ë¼ì„œ ìŠ¤í”„ë§ ê³µì‹ë¬¸ì„œì—ì„œë„ ìƒì„±ì ì£¼ì… ë°©ì‹ì„ ê¶Œê³ í•œë‹¤.
- ìˆœí™˜ ì°¸ì¡°ë¥¼ ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ ì°¾ì•„ë‚¼ ìˆ˜ ìˆë‹¤.

<aside>
ğŸ’¡ **ìˆœí™˜ì°¸ì¡°ë€?**

</aside>

ìˆœí™˜ ì°¸ì¡°ë€ ì„œë¡œ ë‹¤ë¥¸ ì—¬ëŸ¬ ë¹ˆë“¤ì´ ì„œë¡œë¥¼ ì°¸ì¡°í•˜ê³  ìˆìŒì„ ì˜ë¯¸í•œë‹¤.

ex) CourseServiceì—ì„œ StudentServiceì— ì˜ì¡´í•˜ê³ , StudentServiceê°€ CourseServiceì— ì˜ì¡´í•˜ë©´ ìˆœí™˜ ì°¸ì¡°ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤

**í•„ë“œ ì£¼ì…ì¸ ê²½ìš°**

```java
@Service
public class CourseServiceImpl implements CourseService {

    @Autowired
    private StudentService studentService;

    @Override
    public void courseMethod() {
        studentService.studentMethod();
    }
}

@Service
public class StudentServiceImpl implements StudentService {

    @Autowired
    private CourseService courseService;

    @Override
    public void studentMethod() {
        courseService.courseMethod();
    }
}
```

**StudentServiceImpl**ì—ì„œë„ **CourseServiceImpl**ì˜ ë©”ì„œë“œë¥¼ ì°¸ì¡°í•˜ì—¬ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê³  ìˆê³ ,

**CourseServiceImpl**ì—ì„œë„ **StudentServiceImpl**ì˜ ë©”ì„œë“œë¥¼ ì°¸ì¡°í•˜ì—¬ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê³  ìˆëŠ”ë°,

ì„œë¡œ ì£¼ê±°ë‹ˆ ë°›ê±°ë‹ˆ í˜¸ì¶œì„ ë°˜ë³µí•˜ë©´ì„œ ëŠì„ì—†ì´ í˜¸ì¶œí•˜ë‹¤ê°€ **StackOverflowError**ë¥¼ ë°œìƒì‹œí‚¤ë‹¤ ì£½ê²Œëœë‹¤.

í•„ë“œ ì£¼ì…ê³¼ ìˆ˜ì •ì ì£¼ì…ì€ ê°ì²´ ìƒì„± í›„, **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìƒ**(í•´ë‹¹ ë©”ì„œë“œê°€ ì‹¤í–‰ë ë•Œ)ì—ì„œ ìˆœí™˜ ì°¸ì¡°ê°€ ì¼ì–´ë‚˜ê¸° ë•Œë¬¸ì— ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ ìˆœí™˜ ì°¸ì¡°ë¥¼ ì¡ì•„ë‚¼ ìˆ˜ ì—†ë‹¤.

**ìƒì„±ì ì£¼ì…ì¸ ê²½ìš°**

```java
@Service
public class CourseServiceImpl implements CourseService {

    private final StudentService studentService;

    @Autowired
    public CourseServiceImpl(StudentService studentService) {
        this.studentService = studentService;
    }

    @Override
    public void courseMethod() {
        studentService.studentMethod();
    }
}

@Service
public class StudentServiceImpl implements StudentService {

    private final CourseService courseService;

    @Autowired
    public StudentServiceImpl(CourseService courseService) {
        this.courseService = courseService;
    }

    @Override
    public void studentMethod() {
        courseService.courseMethod();
    }
}
```

í•˜ì§€ë§Œ ìƒì„±ì ì£¼ì…ì¼ ë•Œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì„ **ì‹¤í–‰**í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ë¡œê·¸ê°€ ë°œìƒí•˜ë©´ì„œ ì‹¤í–‰ì´ ì‹¤íŒ¨í•œë‹¤.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/33bf96cc-c7fe-4b18-a1a7-5a05eeb5927e/f7ae58a5-7c2b-473b-9e2a-8f6cc6fea0ae/Untitled.png)

---

### ğŸ“Œ @Autowired

DIë¥¼ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë©°, ì˜ì¡´ ê´€ê³„ì˜ íƒ€ì…ì— í•´ë‹¹í•˜ëŠ” ë¹ˆì„ ì°¾ì•„ ì£¼ì…í•˜ëŠ” ì—­í• ì„ í•œë‹¤.

ìŠ¤í”„ë§ ì„œë²„ê°€ ì˜¬ë¼ê°ˆ ë•Œ, **Application Context**ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ê°€ **@Bean**ì´ë‚˜ **@Service, @Controller** ë“±ì˜ ì–´ë…¸í…Œì´ì…˜ì„ ì´ìš©í•˜ì—¬ ë“±ë¡í•œ **@Autowired** ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ ìœ„ì¹˜ì— ì˜ì¡´ ê´€ê³„ ì£¼ì…ì„ ìˆ˜í–‰í•œë‹¤.

ì´ë•Œ, **@Autowired** ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ ìœ„ì¹˜ì— ì˜ì¡´ ê´€ê³„ë¥¼ ì£¼ì…í•˜ëŠ” ì›ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

- @Autowired ì–´ë…¸í…Œì´ì…˜

```java
/**
* Note that actual injection is performed through a **BeanPostProcessor** which in turn means
* that you cannot use @Autowired to inject references into BeanPostProcessor or 
* BeanFactoryPostProcessor types. Please consult the javadoc for the 
* **AutowiredAnnotationBeanPostProcessor** class (which, by default, checks for the presence 
* of this annotation).
* Since:
* 2.5
* See Also:
* AutowiredAnnotationBeanPostProcessor, Qualifier, Value
* Author:
* Juergen Hoeller, Mark Fisher, Sam Brannen
*/
@Target({ElementType.CONSTRUCTOR, ElementType.METHOD, ElementType.PARAMETER, ElementType.FIELD, ElementType.ANNOTATION_TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface Autowired {
    boolean required() default true;

}
```

ì½”ë“œ ìƒë‹¨ì˜ ì£¼ì„ì„ ë³´ë©´, ì‹¤ì œ íƒ€ê¹ƒì— Autowiredê°€ ë¶™ì€ ë¹ˆì„ ì£¼ì…í•˜ëŠ” ê²ƒì€ **BeanPostProcessor**ë¼ëŠ” ë‚´ìš©ì„ ì°¾ì„ ìˆ˜ ìˆê³ , ê·¸ê²ƒì˜ êµ¬í˜„ì²´ëŠ” **AutowiredAnnotationBeanPostProcessor**ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/33bf96cc-c7fe-4b18-a1a7-5a05eeb5927e/ce151ccc-f079-4aae-b704-aed09634b4a6/Untitled.png)

***AutowiredAnnotationBeanPostProcessorÂ í´ë˜ìŠ¤***

```java
public void processInjection(Object bean) throws BeanCreationException {
        Class<?> clazz = bean.getClass();
        InjectionMetadata metadata = findAutowiringMetadata(clazz.getName(), clazz, null);
        try {
                metadata.inject(bean, null, null);
        }
        catch (BeanCreationException ex) {
                throw ex;
        }
        catch (Throwable ex) {
                throw new BeanCreationException(
                        "Injection of autowired dependencies failed for class [" + clazz + "]", ex);
        }
}
```

AutowiredAnnotationBeanPostProcessorÂ í´ë˜ìŠ¤ ë‚´ì— **processInjection**( ) ë©”ì„œë“œê°€ ìˆê³ , ì´ëŠ” ì–´ë…¸í…Œì´ì…˜ëœ í•„ë“œë‚˜ ë©”ì„œë“œì— ëŒ€í•´ ê°ì²´ë¥¼ ì£¼ì…í•˜ëŠ” ì—­í• ì„ í•œë‹¤.

---

## ğŸ“• 2.2.2 ë¹ˆê³¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ

### **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ**

ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ìŠ¤í”„ë§ ë¹ˆì´ ìƒì„±ë˜ê³  ì†Œë©¸ë˜ê¸°ê¹Œì§€ì˜ ìƒëª…ì£¼ê¸°ë¥¼ ì´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•œë‹¤.

### **ìŠ¤í”„ë§ ë¹ˆ**

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ëŠ” ê°ì²´ì´ë‹¤.
- ìŠ¤í”„ë§ì€ ë¹ˆì„ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë“±ë¡í•˜ê¸° ìœ„í•´ XML íŒŒì¼ ì„¤ì •, ì• ë„ˆí…Œì´ì…˜ ì¶”ê°€ ë“±ì˜ ë°©ë²•ì„ ì œê³µí•œë‹¤.
- í´ë˜ìŠ¤ì— ì–´ë…¸í…Œì´ì…˜ ì¤‘ì—ì„œ **`@Component`** ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì´ë©´ í•´ë‹¹ í´ë˜ìŠ¤ê°€ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ë©°, ì´ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ê´€ë¦¬í•œë‹¤.

### ğŸ“Œ **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— Bean ì´ ìƒì„±ë˜ëŠ” ê³¼ì •**

**Component Scan ì–´ë…¸í…Œì´ì…˜**

ìŠ¤í”„ë§ë¶€íŠ¸ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ê²Œ ë˜ë©´ ê°€ì¥ ìƒìœ„ í´ë˜ìŠ¤ì— **`@SpringBootApplication`**ì´ ì¡´ì¬í•œë‹¤.

```java
@SpringBootApplication
public class Application {

    public static void main(String[] args) {
    	SpringApplication.run(Application.class, args);
    }

}
```

`**@SpringBootApplication**` ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬í˜„ë˜ì–´ ìˆë‹¤.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/33bf96cc-c7fe-4b18-a1a7-5a05eeb5927e/4b10ddbb-264d-4e5f-85ed-cee34ce59279/Untitled.png)

**`@ComponentScan`** ì–´ë…¸í…Œì´ì…˜ì€ @Component ì–´ë…¸í…Œì´ì…˜ì´ë‚˜ stereotype(@Service, @Controller, @Repository ë“±) ì–´ë…¸í…Œì´ì…˜ì´ ë¶€ì—¬ëœ classë¥¼ ì°¾ì•„ ìë™ìœ¼ë¡œ Beanìœ¼ë¡œ ë“±ë¡í•´ì£¼ëŠ” ì—­í• ì„ í•œë‹¤.

### ğŸ“Œ **ìš©ë„ë³„ ë¹ˆ ë“±ë¡ ì–´ë…¸í…Œì´ì…˜ëª…**

ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë¹ˆì„ ë“±ë¡í•˜ê¸° ìœ„í•œ ì–´ë…¸í…Œì´ì…˜ì€ **`@Component`** ì´ë©°,

ë‹¤ìŒì˜ ìš©ë„ì— ë”°ë¼ **`@Component`** ì–´ë…¸í…Œì´ì…˜ì´ í¬í•¨ëœ ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•œë‹¤.

| ì–´ë…¸í…Œì´ì…˜ | ì„¤ëª… |
| --- | --- |
| @Configuration | ì„¤ì • íŒŒì¼ ë“±ë¡ |
| @Repository | ORM ë§¤í•‘ |
| @Controller, @RestController | ë¼ìš°í„° |
| @Service | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ |

- **Service ì–´ë…¸í…Œì´ì…˜ ì½”ë“œ**

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/33bf96cc-c7fe-4b18-a1a7-5a05eeb5927e/a4f9836c-02c0-42c0-a6d0-14333e3d8485/Untitled.png)

---

## ğŸ“•  2.2.3 ê´€ì  ì§€í–¥ í”„ë¡œê·¸ë˜ë°

### ğŸ“Œ AOP( Aspect Oriented Programming )ë€?

- ê´€ì  ì§€í–¥ í”„ë¡œê·¸ë˜ë°ì´ë€, **í•µì‹¬ ê´€ì , ë¶€ê°€ ê´€ì **ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ê´€ì‹¬ ê¸°ì¤€ìœ¼ë¡œ í”„ë¡œê·¸ë¨ì„ ëª¨ë“ˆí™”í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

- **AOP ì˜ˆì‹œ**

ë‹¤ìŒê³¼ ê°™ì´ í´ë˜ìŠ¤ A, B, C ì—ì„œ ê³µí†µì ìœ¼ë¡œ ë‚˜íƒ€ë‚´ëŠ” ìƒ‰ê¹” ë¸”ë¡ì´ ì¤‘ë³µë˜ëŠ” ë©”ì„œë“œ, í•„ë“œ, ì½”ë“œë¼ê³  í• ë•Œ, í´ë˜ìŠ¤ Aì˜ ë¹¨ê°„ìƒ‰ ë¶€ë¶„ì„ ìˆ˜ì •í•´ì•¼ í•˜ëŠ” ìƒí™©ì´ ë°œìƒí•˜ë©´, í´ë˜ìŠ¤ B, Cì˜ ë¶€ë¶„ë„ ì¼ì¼ì´ ì°¾ì•„ ìˆ˜ì •í•´ì•¼ í•œë‹¤.

ì´ë ‡ê²Œ ë˜ë©´ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë ¤ì›Œì§€ë©°, ì´ë¥¼ í©ì–´ì§„ ê´€ì‹¬ì‚¬ë¼ê³  ë¶€ë¥¸ë‹¤.

AOPì—ì„œëŠ” ì´ë¥¼ ê° ê´€ì ì„ ê¸°ì¤€ìœ¼ë¡œ ë¡œì§ì„ ì£¼í™©ìƒ‰, íŒŒë€ìƒ‰, ë¹¨ê°„ìƒ‰ ë¸”ë¡ì²˜ëŸ¼ ëª¨ë“ˆí™”í•˜ê³ , ì–´ë””ì— ì ìš©ì‹œí‚¬ì§€ë§Œ ì •ì˜í•œë‹¤. 

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/33bf96cc-c7fe-4b18-a1a7-5a05eeb5927e/8f58a32c-af7a-4b86-b398-43e87945f67e/Untitled.png)

### ğŸ“Œ AOP ìš©ì–´

| ìš©ì–´ | ì˜ë¯¸ |
| --- | --- |
| Aspect | í©ì–´ì§„ ê´€ì‹¬ì‚¬ë¥¼ ëª¨ë“ˆí™” í•œ ê²ƒ. |
| Target | Aspectë¥¼ ì ìš©í•˜ëŠ” ê³³. í´ë˜ìŠ¤, ë©”ì„œë“œ ë“±.. |
| Advice | ì‹¤ì§ˆì ìœ¼ë¡œ ì–´ë–¤ ì¼ì„ í•´ì•¼ í•  ì§€ì— ëŒ€í•œ ê²ƒ, ì‹¤ì§ˆì ì¸ ë¶€ê°€ê¸°ëŠ¥ì„ ë‹´ì€ êµ¬í˜„ì²´ |
| Join Point | Adviceê°€ ì ìš©ë  ìœ„ì¹˜ í˜¹ì€ ë¼ì–´ë“¤ ìˆ˜ ìˆëŠ” ì‹œì . ë©”ì„œë“œ ì§„ì… ì‹œì , ìƒì„±ì í˜¸ì¤„ ì‹œì , í•„ë“œì—ì„œ êº¼ë‚´ì˜¬ ì‹œì  ë“± ë¼ì–´ë“¤ ì‹œì ì„ ì˜ë¯¸. ì°¸ê³ ë¡œ ìŠ¤í”„ë§ì—ì„œ Join PointëŠ” ì–¸ì œë‚˜ ë©”ì„œë“œ ì‹¤í–‰ ì‹œì ì„ ì˜ë¯¸ í•œë‹¤. |
| Point Cut | Join Pointì˜ ìƒì„¸í•œ ìŠ¤í™ì„ ì •ì˜í•œ ê²ƒ. "Aë€ ë©”ì„œë“œì˜ ì§„ì… ì‹œì ì— í˜¸ì¶œí•  ê²ƒ"ì²˜ëŸ¼ êµ¬ì²´ì ìœ¼ë¡œ Adviceê°€ ì‹¤í–‰ë  ì‹œì ì„ ì •í•¨. |

### ğŸ“Œ AOP ì ìš© ë°©ë²•

1. **ì»´íŒŒì¼ íƒ€ì„ ì ìš©**
-> ì»´íŒŒì¼ ì‹œì ì— ë°”ì´íŠ¸ ì½”ë“œë¥¼ ì¡°ì‘í•˜ì—¬ AOPê°€ ì ìš©ëœ ë°”ì´íŠ¸ ì½”ë“œë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•.
2. **ë¡œë“œ íƒ€ì„ ì ìš©**
-> ìˆœìˆ˜í•˜ê²Œ ì»´íŒŒì¼í•œ ë’¤, í´ë˜ìŠ¤ë¥¼ ë¡œë”©í•˜ëŠ” ì‹œì ì— í´ë˜ìŠ¤ ì •ë³´ë¥¼ ë³€ê²½í•˜ëŠ” ë°©ë²•
3. **ëŸ°íƒ€ì„ ì ìš©**
->Â ìŠ¤í”„ë§ AOPê°€ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•. Aë¼ëŠ” í´ë˜ìŠ¤ íƒ€ì…ì˜ Beanì„ ë§Œë“¤ ë•Œ A íƒ€ì…ì˜ **Proxy Bean**ì„ ë§Œë“¤ì–´ Proxy Beanì´ Aspect ì½”ë“œë¥¼ ì¶”ê°€í•˜ì—¬ ë™ì‘í•˜ëŠ” ë°©ë²•.

### ğŸ“Œ AOP êµ¬í˜„ ì˜ˆì œ

**ì˜ì¡´ì„± ì¶”ê°€**

- maven

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-aop</artifactId>
</dependency>
```

- gradle

```groovy
implementation 'org.springframework.boot:spring-boot-starter-aop'
```

1. **íŠ¹ì • ê²½ë¡œ íƒ€ê²Ÿ**

íŠ¹ì • íƒ€ê²Ÿ ë©”ì„œë“œì˜ ì‹¤í–‰ ì‹œê°„ì„ ì¸¡ì •í•´ì£¼ëŠ” ë¡œì§( com.example ë°‘ì˜ ëª¨ë“  í´ë˜ìŠ¤ì— ì ìš©í•˜ê³ , EventService ë°‘ì˜ ëª¨ë“  ë©”ì„œë“œì— ì ìš©í•˜ë¼ëŠ” ëœ» )

```java
@Component
@Aspect
public class PerfAspect {

    @Around("execution(* com.example..*.EventService.*(..))")
    public Object logPerf(ProceedingJoinPoint pjp) throws Throwable {
        long begin = System.currentTimeMillis();
        Object reVal = pjp.proceed();
        System.out.println(System.currentTimeMillis() - begin);
        return reVal;
    }
}
```

1. **íŠ¹ì • ì–´ë…¸í…Œì´ì…˜**

íŠ¹ì • ì–´ë…¸í…Œì´ì…˜ì— ë¡œì§ì„ ì ìš©(@PerfLogging ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì£¼ê¸°ë§Œ í•˜ë©´ logPerf() ê¸°ëŠ¥ì´ ì ìš©ëœë‹¤ëŠ” ëœ»)

```java
@Component
@Aspect
public class PerfAspect {

  @Around("@annotation(PerfLogging)")
  public Object logPerf(ProceedingJoinPoint pjp) throws Throwable {
    long begin = System.currentTimeMillis();
    Object retVal = pjp.proceed();
    System.out.println(System.currentTimeMillis() - begin);
    return retVal;
  }
}
```

1. **íŠ¹ì • Bean ì „ì²´ì— í•´ë‹¹ ê¸°ëŠ¥ ì ìš©** 

simpleServiceEvent ë¹ˆì´ ê°€ì§€ê³  ìˆëŠ” ëª¨ë“  public ë©”ì„œë“œì— ì ìš©

```java
// Aspect ì •ì˜
@Component
@Aspect
public class PerfAspect {

  // ë¹ˆì´ ê°€ì§€ê³ ìˆëŠ” ëª¨ë“  í¼ë¸”ë¦­ ë©”ì˜ë“œ
  @Around("bean(simpleServiceEvent)")
  public Object logPerf(ProceedingJoinPoint pjp) throws Throwable {
    long begin = System.currentTimeMillis();
    Object retVal = pjp.proceed();
    System.out.println(System.currentTimeMillis() - begin);
    return retVal;
  }
}
```